
---
### 10.0-软件工程-系统维护、净室工程和基于构件的软件工程

遗留系统处置方式:
1. 强价值+强技术 -> 改造
2. 弱价值+强技术 -> 集成
3. 弱价值+弱技术 -> 淘汰
4. 强价值+弱技术 -> 继承

系统维护包括: 软件维护、硬件维护、数据维护。软件维护类型包括
1. 正确性维护
2. 适应性维护
3. 完善性维护
4. 预防性维护

基于构件的软件工程 (CBSE)过程中的6个主要活动
1. 系统需求概述
2. 识别候选构件
3. 根据发现的构件修改需求
4. 体系结构设计
5. 构建的制定和适配
6. 组装构建创建系统

---
### 11.2-面向对象技术-UML图

UML的基本构造块
1. 事物
2. 关系
3. 图

UML的4种事物
1. 结构事物: 类、接口、用例、构件等。
2. 行为事物: 交互、活动、状态机等。
3. 分组事物: 包等。
4. 注释事物: 

UML的关系
1. 依赖 ----→
2. 关联 ————
3. 聚合(弱关联性) ————◇
4. 组合(强关联性) ————◇[实心]
5. 泛化(子类和父类之间的关系) ————▷
6. 实现(接口实现) ----▷

UML的图
1. 类图(静态图)
2. 对象图(静态图)
3. 用例图(静态图), 关系有: 包含(<<include>>)、拓展(<<extend>>)、泛化
4. 序列图(动态图), 可称之为顺序图, 同步消息(————▷[实心]), 异步消息(————▷), 返回消息(←----)
5. 通信图(动态图)
6. 状态图(动态图)
7. 活动图(动态图)
8. 构件图(静态图)
9. 部署图(静态图)

---
### 11.3 设计模式

##### 创建型
1. 工厂方法模式 - factory method
2. 抽象工厂模式 - abstract factory
3. 原型模式 - prototype
4. 单例模式 - singleton
5. 构建器模式 - builder

##### 结构型模式
1. 适配器模式 - adapter
2. 桥接模式 - bridge
3. 组合模式 - composite
4. 装饰器模式 - decorator
5. 外观模式 - facade
6. 享元模式 - flyweight
7. 代理模式 - proxy

##### 行为模式
1. 职责链模式 - chain of responsibility
2. 命令模式 - command
3. 解释器模式 - interpreter
4. 迭代器模式 - iterator
5. 中介者模式 - mediator
6. 备忘录模式 - memento
7. 观察者模式 - observer
8. 状态模式 - state
9. 策略模式 - strategy
10. 模板方法模式 - template method
11. 访问者模式 - visitor

---
### 12.1项目管理-进度管理

##### 7格表示法
|最早开始时间 |     工期   | 最早完成时间|
|      -     |      -     |       -    |
|            |  活动编号  |             |
|最晚开始时间 | 总浮动时间  | 最晚完成时间|

---
### 12.2配置与质量与风险管理

##### 配置管理的6个主要活动
1. 指定配置管理计划
2. 配置标识
3. 配置控制
4. 配置状态报告
5. 配置审计
6. 发布管理和交付

##### 配置项
**典型的配置项**
1. 项目计划书
2. 需求文档
3. 设计文档
4. 源代码
5. 可执行文件
6. 测试用例
7. 运行软件所需要的各种数据

配置项可分为, **基线配置项**和**非基线配置项**。

配置项的状态: **草稿**、**正式**、**修改**。

##### 配置项版本号表示方式
草稿: 0.YZ,  YZ的数字取值范围0~9
正式: X.Y,  X主版本号, 取值范围1~9、Y次版本号, 取值范围0~9
修改: X.YZ, Z取值0~9

---
###13.1系统架构设计-系统架构设计概述
暂无笔记...

---
### 13.2系统架构设计-构件

**在<font color="red">包含</font>重用形式下, 一个外部对象拥有一个内部对象的唯一引用, 外部对象只是吧请求转发给内部对象。**
**在<font color="red">聚集</font>重用像是下, 直接把内部对象的接口引用传给外部对象, 而不在是转发请求。**

---
### 13.3系统架构设计-系统架构风格
软件架构风格: 描述某一特定应用领域中系统组织方式的惯用描述。
##### 数据流风格
1. 批处理序列: 每个处理步骤都是一个独立的程序, 每一步必须在其前面一步已完成之后进行, 数据是整体的。
2. 管道过滤器: 前一个构件的输出作为下一个构件的输入。

##### 调用/返回风格
1. 主程序/子程序
2. 面向对象: 构件既是对象, 对象间通过函数和过程调用来进行交互。
3. 层次结构: 可以将复杂的问题, 分解成一个增量步骤来实现。层次调用影响效率。
4. 客户端服务器(C/S): 两层(胖客户端, 瘦服务器), 三层(表示层、功能层、数据层)

##### 独立构件风格
1. 进程通信: 构件是独立的进程, 链接件是消息传递。
2. 事件驱动系统(隐式调用): 构件不直接调用一个过程, 而是通过触发或者广播一个或多个事件。

##### 虚拟机风格
1. 解释器: 通过包括解释器、被解释代码的存储区、记录解释器工作转态数据结构、记录源代码被解释执行的进度数据结构。执行效率较低。
2. 基于规则的系统: 包括规则集、规则解释器、规则/数据解释器、工作内存。一般用于人工智能领域和DSS(决策支持系统)。通常用不实现灵活的业务规则和决策逻辑。

##### 数据为中心系统
1. 仓库风格: 将数据存储在中央数据仓库, 各构件可对数据仓库进行读写数据, 构件间通过数据仓库进行通信和协作。
2. 黑板风格: 多个独立的构件共享一个数据存储区,根据共享信息进行推断和决策, 适用于解决复杂的非结构化问题。

##### 其它架构风格
1. 闭环控制: 当软件用来操控一个物理系统时, 软件和硬件之间可以粗略的标识为一个反馈循环, 这个循环通过接收一定的输入, 确定一定的输出, 最终使环境达到一个新的状态。
2.C2体系结风格: 通过连接件绑定在一起的按照一组规则运作的并行构件网络。 

---
### 13.4系统架构设计-软件复用、ABSD和DSSA

##### 软件架构复用
- 软件架构复用根据复用时机和分为<font color="red">机会复用</font>和<font color="red">系统复用</font>

##### DSSA特定领域软件架构
- 垂直领域: 在一个特定领域中通用的软件架构。
- 水平领域: 在多个不同的特定领域之间的相同的部分的小工具。

**三个基本活动**
1. **领域分析**: 获取领域模型(领域需求)。
2. **领域设计**: 获得特定领域软件架构(DSSA)。
3. **领域实现**: 开发和组织可重用信息, 实现基础软件架构。将结构转换为具体的应用程序。

<font color="red">这个过程有助于确保系统能够满足特定领域的需求,并具备可维护和可重用的特性。</font>

参与DSSA的四种角色人员: **领域专家**、**领域分析人员**、**领域设计人员**、**领域实现人员**。

##### ABSD基于架构的软件开发方法
ABSD方法是架构驱动, 强调由业务、质量、功能需求的组合驱动架构设计。强调采用视角和视图描述结构, **用例**和**质量属性场景**来描述需求。**用例**描述的是功能需求, **质量属性场景**描述的是质量需求。

ABSD开发过程步骤
1. 体系结构(架构)需求
2. 体系结构(架构)设计
3. 体系结构(架构)文档化: 体系结构(架构)规格说明、测试体系结构(架构)需求的质量设计说明书。
4. 体系结构(架构)复审
5. 体系结构(架构)实现
6. 体系结构(架构)演化

---
### 14.1层次架构风格和面向服务架构风格

**富互联网应用（Rich Internet Application，简称RIA）**
1. 用户体验：提供高度交互性、直观性和响应速度快的用户界面，使用户获得更好的使用体验。
2. 动态内容：通过异步加载和更新数据，实现无需刷新页面即可更新内容，并能够实时反馈用户操作。
3. 多媒体支持：支持多种媒体格式，如音频、视频和图形，以增强用户体验。
4. 跨平台：能够在不同的操作系统和设备上运行，包括桌面、移动设备和平板电脑等。
5. 离线访问：通过本地存储技术，使应用程序能够在离线状态下继续工作，并在重新连接到互联网时进行同步。

##### 层次架构风格
- MVC架构: Controller、View、Model
- MVP架构: Presenter、View、Model
- MVVM架构: ViewModel、View、Model

##### 面向服务架构风格(SOA)
**多个服务通过企业服务总线(ESB)提出服务请求**

**SOA中应用端额关键技术**
1. UDDI: 用于WEB服务注册统一描述、发现、集成。
2. WSDL: 用于描述服务。
3. SOAP: 用户交换XML编码信息的轻量级协议, 用于传递消息。
4. XML: 标识数据的基本格式, 用于数据交换。

---
### 14.2-质量属性和架构评估

##### 质量属性场景
**软件系统属性包括**: *功能属性* 和 *质量属性*
**开发期质量属性**
- 易理解性
- 可拓展性
- 可重用性
- 可测试性
- 可维护性
- 可移植性

**运行期质量属性**
- 性能: 系统的响应能力。如响应时间、吞吐量。
- 安全性: 保密性、完整性、不可抵赖性、可控性。
- 可伸缩性
- 互操作性
- 可靠性: 系统在一定时间内持续无故障运行的能力。MTTF(平均无故障时间)、MTBF(平均故障间隔时间)、MTTR(平均故障恢复事件) MTBF=MTTF+MTTR。
- 可用性: 系统在需要的时候可以提供使用的能录。
- 鲁棒性: 系统在非正常情况下仍能正常运行的能力。也称之为健壮性和容错性。

**质量属性场景的组成部分**
- 刺激源
- 刺激
- 环境
- 制品
- 响应
- 响应量度


##### 系统架构评估
**敏感点**:是指为了实现某一种特定的质量属性, 一个或者多个构件所具有的特性。
**权衡点**: 是影响多个质量属性的特性, 是多个质量属性的敏感点。

**系统架构评估的三种常用评估方式**
1. 基于调查问卷的方式: 要求评估人员对领域和架构具有一定的了解。
2. 基于度量的方式: 指定一些定量指标来度量结构。要求评估人员对架构的技术细节和度量标准有一定的理解。
3. 基于场景的方式: 从风险承担者的角度与系统就的简单描述。要求评估人员对领域和架构熟悉。
三个方面对场景进行设计: 刺激、环境、响应
4. 基于场景的架构分析方法SAAM: 是一种非功能质量属性架构分析方法。包括5个步骤-场景开发、架构描述、单个场景评估、场景交互、总体评估。
5. 架构权衡分析法ATAM: 在系统开发前, 针对性能、可用性、安全性和可修改性等质量属性进行评价和折中, 让架构师明确如何权衡多个质量目标。
四个主要活动: **场景和需求收集**、**体系结构视图和场景实现**、**属性模型构造和分析**、**架构评审和折中**。强调质量属性作为架构评估的核心。
效用树的结构: 树根-质量属性-质量分类-质量属性场景。
6. 成本效益分析法CBAM:用来对架构建立的成本来进行设计和建模, 让决策者根据投资收益率开选择合适的架构, 可以看做对ATAM的补充, 在ATAM确定质量合理的基础上, 再对效益进行分析。

**4+1视图**
- 逻辑视图（Logical View）：该视图描述了系统的功能和结构。它通常包括类图、组件图和包图等，用于展示系统的静态结构和组织关系。
- 开发视图（Development View）：该视图关注系统的软件开发过程和组织结构。它描述了系统的模块化、构建过程和开发团队的组织结构。
- 进程视图（Process View）：该视图描述了系统的并发性和分布式特性。它展示了系统中各个进程（或线程）之间的交互和通信方式。
- 物理视图（Physical View）：该视图关注系统的部署和物理架构。它描述了系统的部署环境、硬件设备和网络拓扑等。
- 场景视图（Scenarios View）：该视图通过使用场景、用例或用户故事等方式，描述了系统在特定环境下的行为和交互。

---
# 15-软件可靠性
暂无笔记...

---
# 16-软件架构的演化和维护
##### 面向对象架构演化
面向对象演化主要包括四种演化: **对象演化**、**消息演化**、**复合片段演化**、**约束演化**。
软件架构的演化时期包括: **设计时演化**、**运行前演化**、**有限制运行时演化**、**运行时演化**。
软件架构的维护过程: **架构知识管理**、**架构修改管理**、**架构版本管理**

---
# 17 未来信息综合技术
暂无笔记...

---
# 18 数学与经济管理知识补充
暂无笔记...

---
# 19-知识产权与标准化
- 注册商标: 有效期20年
- 专利权: 有效期10年
- 著作权: 有效期50年

---
# 20-架构案例分析-上

- 软件架构风格
- 架构风险
- 风险点与非风险点
- 质量属性和效用树
- 敏感点和权衡点
- 典型架构

##### 软件工程-结构话分析方法
结构化的特点: **自顶向下**、**逐步分解**、**面向数据**。
三大模型: 
- **功能模型(数据流图, DFD)**: 数据流、加工、数据存储、外部实体
- **行为模型(状态装换图, STD)**: 状态、事件 
- **数据模型(E-R图, CR)**: 实体、联系
- **数据字典**: 数据元素、数据结构、数据流、数据加工、数据存储、外部实体

##### 软件工程-面向对象分析方法
包含5个活动: **认定对象**、**组织对象**、**描述对象间的相互作用**、**确定对象的操作**、**确定对象的内部信息**。


**案例分析1**
解释系统架构风险、敏感点、权衡点定义。

系统架构风险是指在系统架构设计过程中存在潜在的问题或者不确定的因素, 可能对系统的架构决策产生负面的影响或风险。
敏感点是指为了实现某一种特定的质量属性, 一个或多个构件所具备的特性。
权衡点是影响多个质量属性的特性, 是多个质量属性的敏感点。


**案例分析2**
某软件公司为其新推出的字处理软件设计了一种脚本语言，专门用于开发该字处理软件的附加功能插件。为了提高该语言的编程效率，公司组织软件工具开发部门为脚本语言研制一套集成开发环境。软件工具开发部门根据字处理软件的特点，对集成开发环境进行了需求分析，总结出以下3项核心需求:
(1)集成开发环境需要提供对脚本语言的编辑、语法检査、解释、执行和调试等功能的支持，并要实现各种功能的灵活组合配置与换。
(2)集成开发环境需要提供一组可视化的编程界面，用户通过对界面元素拖拽和代码填充的方式就可以完成功能插件核心业务流程的编写与组织。
(3)在代码调试功能方面，集成开发环境需要实现在脚本语言编辑界面中的代码自动定位功能。县体来说，在调试过程中编辑界面需要响应调试断点命中事件，并自动跳转到当前断点处所对应的代码。

针对上述需求，软件工具开发部门对集成开发环境的架构进行分析与设计，王工认为该集成开发环境应该采用管道-过滤器的架构风格实现，李工则认为该集成开发环境应该采用以数据存储为中心的架构风格来实现。公司组织专家对王工和李工的方案进行了评审，最终采用了李工的方案。

【问题1】(12分)请用200字以内的文字解释什么是软件架构风格，并从集成开发环境与用户的交互方式集成开发环境的扩展性、集成开发环境的数据管理三个方面说明为什么最终采用了李工的设计方案。
答:
软件架构风格是指描述特定软件系统组织方式的惯用模式, 用于指导和组织软件系统的整体结构和组件之间的关系, 反应了众多系统共有的结构和语义。
从集成环境和用户的交互方式看, 采用以数据为中心的架构风格能够很好的支持交互数据的共享处理。
从集成环境和可拓展性来看, 以数据为中心的架构风格可以降低组件之间的耦合度, 以数据为中介, 组件可以独立的处理数据, 使系统具有更好的灵活性和可拓展性。
从集成环境的数据管理来看, 集成环境需要保存和处理多钟数据格式, 以数据为中心的架构风格, 将数据统一存储, 中心存储器可以表示多种数据格式, 并能为多种数据格式的转换提供支持。而管道过滤器架构风格通常对数据格式的支持有限, 并且数据格式处理转换方面的灵活性较差。

【问题2】(13分)在对软件系统架构进行设计时，要对架构需求进行分析，针对特定需求选择最为合适的架构风格，因此实际的软件系统通常会混合多种软件架构风格。请对核心需求进行分析，说明为了满足需求(2)和(3)，分别应采用何种架构风格，并概要说明采用相应架构风格后的架构设计过程。
答:
满足需求(2)适合采用解释器架构风格。具体实现步骤:
①为可视化编程元素和其拖拽关系定义号某种语音, 并描述语法和语义。
②编写解释器对该语音进行解释。
③通过解释生成对应的脚本语音程序。

满足需求(3)适合采用隐式调用架构风格。具体实现步骤:
①定义"断点在调试工程中命中"的事件, 并实现断定命中后定位屏幕的函数。
②集成环境维护一个时间祖册表结构, 将该事件和屏幕定位函数进行绑定。
③调试工程中, 集成环境负责监听各种事件, 在出发"断点在调试工程中命中"事件时, 调用绑定的屏幕定位函数, 来实现脚本语言编辑界面中的代码自动定位功能。

**案例分析3**
阅读以下关于软件系统设计的叙述，在答题纸上回答问题1至问题3。【说明】
某文化产业集团委托软件公司开发一套文化用品商城系统，业务涉及文化用品销售、定制、竞拍和点评等板块以提升商城的信息化建设水平。该软件公司组织项目组完成了需求调研，现已进入到系统架构设计阶段。考虑到系统需求对架构设计决策的影响，项目组先列出了可能影响系统架构设计的部分害求如下:

(a)用户界面支持用户的个性化定制;
(b)系统需要支持当前主流的标准和服务，特别是通信协议和平台接口;
(c)用户操作的响应时间应不大于3秒，竟拍板块不大于1秒;
(d)系统具有故障诊断和快速恢复能力;
(e)用户密码需要加密传输;
(f)系统需要支持不低于2G的数据缓存;
(g)用户操作停滞时间超过一定时限需要重新登录验证;
(h)系统文持用户选择汉语、英语或法语三种语言之一进行操作;

项目组提出了两种系统架构设计方案:瘦客户端c/s架构和胖客户端c1s架构，经过对上述需求逐条分析和讨论。
最终决定采用瘦客户端c/s架构进行设计。

【问题1】(8分)在系统架构设计中，决定系统架构设计的非功能性需求主要有四类:操作性需求、性能需求、安全性需求和文化需求。请简要说明四类需求的含义。
答:
性能需求是指系统响应时间、吞吐量、准确性、有效性、资源利用率等系统完成任务效率相关的指标。可靠性、可用性等性能指标都归属于此类。
操作性需求是指用户操作使用系统相关的一系列需求。
安全性需求是指系统能够满足保护系统和数据免受未经授权访问、损坏或泄漏的需求和措施。
文化需求是指系统在设计和实施过程中, 确保系统和组织的文化价值观、行为准则相一致的需求和考虑。

【问题2)(8分)将题干所给出的系统需求(a)~(h)分别填入(1)~(4)。需求分类如下
操作性需求: 	(1) -> a,b
性能需求: 	(2) -> c,d,f
安全性需求:	(3) -> e, g
文化需求: 	(4) -> h

【问题3】(9分)
请说明瘦客户端c/s架构能够满足题干中给出的哪些系统需求(只需要回答出三个系统需求)。
c: 可有服务端添加集群支持
d: 应用逻辑层在服务端, 只需恢复服务端程序即可
e: 逻辑处理层在服务端, 可以支持加密处理传输

**案例分析3**
(1)信息工程方法中的“实体(entity)”与面向对象方法中的'类(class)”之间有哪些不同之处?
(2)在面向对象方法中通常采用用例(Use Case)来捕获系统的功能需求。用例可以按照不同的层次来进行划分，其中的Essential Use Cases和Real UseCases有哪些区别?
答:
(1)
实体用于数据建模, 而类用不面向对象建模。 实体只有属性, 类具有属性和操作。
(2)
Essential Use Cases翻译为抽象用例, Real UseCases翻译为基础用例。基础用例是实实在在和拥挤需求相关联的需求, 是从用户需求获取的渠道得到的。而抽象需求是从基础用例中抽取的用例公共部分, 是为避免重复工作, 优化结构而提出的用例。

**案例分析4**
请用400字以内文字说明拟编制项目计划中应包括哪些内容，
①项目背景
②项目经理、项目经理的主管领导、客户联系人、客户方主管领导、项目管理团队和项目实施小组等项目相关人员
③项目的总体技术解决方案
④所选择的项目管理过程及执行水平
⑤对这些过程的工具、技术和输入输出描述
⑥选择的项目的生命周期和相关的项目阶段
⑦项目最终目标和阶段性目标
⑧进度计划
⑨项目预算
⑩变更流程和变更控制委员会
 对于内容、范围和时间的关键管理评审, 以便于确定悬留问题和未解决决策

**案例分析5**
阅读以下关于分布式数据库缓存设计的叙述，在答题纸上回答问题1至问题3.【说明)

某企业是为城市高端用户提供高品质蔬菜生鲜服务的初创企业，创业初期为快速开展业务，该企业采用轻量型的开发架构(脚本语言+关系型数据库)研制了一套业务系统。业务开展后受到用户普遍欢迎，用户数和业务数量迅速增长，原有的数据库服务器已不能满足高度并发的业务要求。为此，该企业成立了专门的研发团队来解决该问题。

张工建议重新开发整个系统，采用新的服务器和数据架构，解决当前问题的同时为日后的扩展提供支持。但是李工认为张工的方案开发周期过长，投人过大，当前应该在改动尽量小的前提下解决该问题。李工认为访问量很大的只是部分数据，建议采用缓存工县MemCache来减轻数据库服务器的压力，这样开发量小，开发周期短比较适合初创公司，同时将来也可以通过集群进行扩展。然而，刘工又认为李工的方案中存在数据可靠性和一致性问题，在宕机时容易丢失交易数据，建议采用Redis 来解决问题。在经过充分讨论，该公司最终决定采用刘工的方案。

【问题1】(9分)在李工和刘工的方案中，均采用分布式数据库缓存技术来解决问题。请说明分布式数据库缓存的基本概念。
表4-1中对MemCache和Redis两种工具的优缺点进行了比较，请补充完善表4-1中的空(1)~(6)。
| | Memcache | Redis |
|-|-|-|
|数据类型|简单的Key/value结构|(1)|
|持久化|(2)|支持|
|分布式存储|(3)|多种但是, 主从、Sentinel\Cluster等|
|多线程支持|支持|(4)|
|内存管理|(5)|无|
|事务支持|(6)|有限支持|
答:
(1) key/value、list、set、hash、ZSet
(2) 不支持
(3) 不支持
(4) 不支持
(5) 支持
(6) 不支持

问题2】(8分)刘工认为李工的方案存在数据可靠性和一致性的问题，请说明原因。为避免数据可靠性和一致性的问题，刘工的方案采用Redis作为数据库缓存，请说明基本的Redis与原有关系数据库的数据同步方案。
答:
MemCache没有持久化能力, 所以宕机后全部数据会丢失, 而且无法直接恢复, 存在可靠性问题, MenCache不支持事务所以存在数据一致性问题。
Redis同步方案: 读取数据时, 先读取Redis缓存, 如果没有则读取数据库并同步更新Redis缓存。 修改时, 修改数据数据的同时, 同步修改Redis缓存中的数据, 或者修改数据的同时, 同步删除Redis中的数据, 触发获取缓存时的数据更新。

【问题3】(8分)请给出Redis 分布式存储的2种常见方案和Redis集群切片的几种常见方式
答:
Redis分布式村存储的两种方案: 主从复制、Redis集群
Redis集群切片的常见方式
- 哈希槽范围切片: 哈希槽被分成固定的数量范围(通常是16384个), Redis节点负责管理其中的一部分槽范围, 数据根据其键进行哈希, 然后分配到相应的槽中
- 一致性哈希切片: 通过一致性哈希算法将不同的槽映射到不同的Redis节点, 数据通过键进行哈希. 然后通过一致性哈希算法找到对应的节点。

---
# 24.架构分析上-数据库系统
**主从服务数据一致性保证**
- 同步复制: 必须确保所有的从机完成同步
- 半同步复制: 至少保证一个从机完成同步操作
- 多版本并发控制(MVCC)
- 事务级别的一致性读取: 使用事务来确保一致性问题


***并发控制*
- 丢失更新: 一级封锁协议
- 脏读: 二级封锁协议
- 不可重复读: 三级封锁协议

**反规范化**
- 增加冗余列: 
- 增加派生列
- 重新组表
- 水平分隔表
- 垂直风格表

**反规范化带来的数据一致性问题**
- 更新异常
- 插入异常

**解决不一致的几种方案**
- 应用触发器
- 使用并发控制机制
- 采用应用程序逻辑

**案例分析1**
阅读以下关于数据库设计的叙述，在答题纸上回答问题1至问题3。【说明】某医药销售企业因业务发展，需要建立线上药品销售系统，为用户提供便捷的互联网药品销售服务、该系统除了常规药品展示、订单、用户交流与反馈功能外，还需要提供当前热销产品排名、评价分类管理等功能。通过对需求的分析，在数据管理上初步决定采用关系数据库(MySQL)和数据库缓存(Redis)的混合架构实现。经过规范化设计之后，该系统的部分数据库表结构如下所示。
供应商(供应商ID，供应商名称，联系方式，供应商地址);
药品(药品ID，药品名称，药品型号，药品价格，供应商ID):
药品库存(药品ID，当前库存数量);
订单(订单号码，药品ID，供应商ID，药品数量，订单金额);

【问题1】(9分)在系统初步运行后，发现系统数据访问性能较差。经过分析，刘工认为原来数据库规范化设计后，关系表过于细分，造成了大量的多表关联查询，影响了性能。例如当用户查询商品信息时，需要同时显示该药品的信息、供应商的信息、当前库存等信息。为此，刘工认为可以采用反规范化设计来改造药品关系的结构，以提高查询性能。修改后的药品关系结构为:药品(药品D，药品名称，药品型号，药品价格，供应商D，供应商名称，当前库存数量);请用200字以内的文字说明常见的反规范化设计方法，并说明用户查询商品信息应该采用哪种反规范化设计方法。
答:
增加冗余列: 在多个表中增保留相同的列, 通过增加数据冗余减少或避免查询的链接操作。
增加派生列: 在本表中增加可以通过本表或其它表的相关字段计算生成的列, 减少查询时的链接和计算操作。
重新组表: 如果需要大量查询两种表连接查询后的结果, 则将这两种表重新组成一张表, 避免链接操作。
水平分隔: 将一种表中不同行的数据, 按指定的算法分别存在到不同的表中。
垂直分隔: 将同一张表中的不同属性, 拆分存储到不同的表中。

使用增加荣誉列的反规范化设计方法

【问题2】(9分)王工认为，反规范化设计可提高查询的性能，但必然会带来数据的不一致性问题。请用200字以内的文字说明在反规范化设计中，解决数据不一致性问题的三种常见方法，并说明该系统应该采用哪种方法。
答:
批处理维护: 指定派生列修改积累一定时间到后, 有批处理程序统一对派生列进行修改。
应用逻辑维护: 通过应该逻辑同步维护派生列。
触发器维护: 增加触发器, 同步修改实时同步修改派生列。

该系统应该采用触发器维护


【问题3】(7分)
该系统采用了Redis来实现某些特定功能(如当前热销药品排名等)，同时将药品关系数据放到内存以提高商品查询的性能但必然会造成Redis和MySQL的数据实时同步问题。
(1)Redis的数据类型包括String、Hash、List、Set和ZSet等，请说明实现当前热销药品排名的功能应该选择使用哪种数据类型。
ZSet: 有序的数据结构, 数据唯一, 每个数据包含一个分数(分数可重复)

(2)请用200字以内的文字解释说明解决Redis和MySQL数据实时同步问题的常见方案。
对于强一致性: 采用实时同步方案, 缓存查询不到再从DB查询, 保存到缓存。更新缓存时, 先更新DB, 在将缓存设置为失效。
对于高并发: 可以使用消息队列的方式同步, 可采用消息中间件来处理消息生产和消费。
使用三方的同步工具, 例如canal, 通过监测BD 的相关日志来触发更新缓存。
采用UDP自定义函数的方式, 面对mysql的API进行编程, 利用触发器进行缓存同步。